var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},a=e.parcelRequired7c6;null==a&&((a=function(e){if(e in t)return t[e].exports;if(e in n){var a=n[e];delete n[e];var r={id:e,exports:{}};return t[e]=r,a.call(r.exports,r,r.exports),r.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){n[e]=t},e.parcelRequired7c6=a),a("krGWQ"),a("4aPXr");var r=a("4aPXr"),s=a("krGWQ");const i=new(0,r.SStorage);(0,s.getRefs)().libraryLogo.addEventListener("click",(function(){i.clear()})),a("2lP43"),a("3tw01"),a("cgCOF"),a("hJCi4");var l=a("hqPq9"),o=a("sgMsR"),c=(s=a("krGWQ"),a("gzWlL")),d=(a("gzWlL"),a("fK7aK")),p=(a("fK7aK"),a("4AmR3"));a("4AmR3"),l=a("hqPq9"),o=a("sgMsR"),s=a("krGWQ"),a("gzWlL"),c=a("gzWlL"),a("fK7aK"),d=a("fK7aK"),a("4AmR3"),p=a("4AmR3");const u=(0,s.getRefs)();function m(){u.libraryBtnW.classList.add("current-btn"),u.libraryBtnQ.classList.remove("current-btn"),o.fbFilmsAuth.isLogin&&(u.library.classList.add("min-height"),(0,c.spinnerOn)(),(0,p.emptyLibraryHide)(),u.library.innerHTML="",g(l.PLACE_W).then((({films:e})=>e.map((({id:e,posters:t,title:n,genres:a,year:r,vote:s})=>({id:e,posters:t,title:n,genres:a,year:r,vote:s}))))).then((e=>{0!==e.length&&(f(e),(0,c.spinnerOff)(),(0,d.renderMarkupList)(u.library,e,d.markupCreating)),0===e.length&&(u.library.classList.remove("min-height"),(0,c.spinnerOff)(),(0,p.emptyLibraryShow)())})))}async function g(e){if(o.fbFilmsAuth.isLogin)try{const t=await l.fbFilmsData.getFilms(e);if(t)return t}catch(e){console.log(e)}}function f(e){return e.forEach((e=>{1===e.genres.length&&(e.genres=[e.genres[0].name]),2===e.genres.length&&(e.genres=[e.genres[0].name,e.genres[1].name]),e.genres.length>2&&(e.genres=[e.genres[0].name,e.genres[1].name,"Other"])}))}u.libraryBtnW.addEventListener("click",m);const h=(0,s.getRefs)();function b(){h.libraryBtnW.classList.remove("current-btn"),h.libraryBtnQ.classList.add("current-btn"),o.fbFilmsAuth.isLogin&&(h.library.classList.add("min-height"),(0,c.spinnerOn)(),(0,p.emptyLibraryHide)(),h.library.innerHTML="",g(l.PLACE_Q).then((({films:e})=>e.map((({id:e,posters:t,title:n,genres:a,year:r,vote:s})=>({id:e,posters:t,title:n,genres:a,year:r,vote:s}))))).then((e=>{0!==e.length&&(f(e),(0,c.spinnerOff)(),(0,d.renderMarkupList)(h.library,e,d.markupCreating)),0===e.length&&(h.library.classList.remove("min-height"),(0,c.spinnerOff)(),(0,p.emptyLibraryShow)())})))}h.libraryBtnQ.addEventListener("click",b),a("ihsYy");s=a("krGWQ");var y=a("4Dq8E");var v=a("lBdXx"),L=a("jrNhD");a("sgMsR");l=a("hqPq9");const w=new(0,a("6sNdw").default),W=(0,s.getRefs)(),q=new(0,y.default);let E=null,k=null;!function(){async function e(e){if(e.target.classList.contains("remove-from-watched")){await l.fbFilmsData.removeFilm(k,"WA");(0,L.addMod)(e.target,"watched"),m()}else if(e.target.classList.contains("add-to-watched")){const t=await q.getById(k),n=await l.fbFilmsData.writeTo(t,"WA");"WA"!==n?.place&&"WA"!==n?.place2||(0,L.removeMod)(e.target,"watched"),m()}}async function t(e){if(e.target.classList.contains("remove-from-queue")){await l.fbFilmsData.removeFilm(k,"QU");(0,L.addMod)(e.target,"queue"),b()}else if(e.target.classList.contains("add-to-queue")){const t=await q.getById(k),n=await l.fbFilmsData.writeTo(t,"QU");"QU"===n?.place||n?.place2,(0,L.removeMod)(e.target,"queue"),b()}}function n(e){s()}function a(e){"Escape"===e.key&&(s(),document.removeEventListener("keydown",a))}function r(e){e.target===e.currentTarget&&(s(),W.modal.removeEventListener("click",r))}function s(){document.body.classList.toggle("modal-open"),W.modal.classList.toggle("is_hidden")}function i(e){w.filmID=k,w.showTrailer(),n()}W.library.addEventListener("click",(function(n){const o=n.target.hasAttribute("data-id");if(k=n.target.dataset.id,n.target===n.currentTarget)return;if(!1===o)return;W.modalFilmWrapper.innerHTML="",document.addEventListener("keydown",a),W.modal.addEventListener("click",r),s(),q.getById(k).then((n=>{var a,r;E=n,a=W.modalFilmWrapper,r=function({title:e,vote:t,votes:n,popularity:a,original_title:r,genres:s,about:i,poster_path:l,posters:o,year:c}){const d=s.map((e=>e.name)).join(", ");return`<div class="modal-container">\n        <div class="poster-thumb">\n          <picture>\n              <source\n              srcset="\n              ${o[4].path} 1x,\n              ${o[5].path} 2x\n              "\n              media="(min-width: 1200px)"\n            />\n              <source\n              srcset="\n              ${o[3].path} 1x,\n              ${o[4].path} 2x\n              "\n              media="(min-width: 768px)"\n            />\n              <source\n              srcset="\n              ${o[3].path} 1x,\n              ${o[4].path} 2x\n              "\n              media="(max-width: 767px)"\n            />\n  \n            <img\n              class="movie-poster"\n              src="${o[3].path}"\n              alt="${e}"\n  \n              loading="lazy"\n            />\n          </picture>\n          <div class="trailer-overlay">\n          <button type="button" class="trailer-play-btn">\n          &#9655;\n              </button>\n          \n          </div>\n        </div>\n  \n        <div>\n          <table class="info">\n            <caption class="movie-title">\n            ${e.toUpperCase()}\n            </caption>\n            <tbody>\n              <tr class="table-row">\n                <td class="td">\n                  <p class="characteristic">Vote / Votes</p>\n                </td>\n                <td class="description">\n                  <span class="vote">${t} </span> &nbsp;\n                  <span class="characteristic">/</span> ${n}\n                </td>\n              </tr>\n              <tr class="table-row">\n                <td class="td">\n                  <p class="characteristic">Popularity</p>\n                </td>\n                <td class="description">${a}</td>\n              </tr>\n              <tr class="table-row">\n                <td class="td">\n                  <p class="characteristic">Original Title</p>\n                </td>\n                <td class="description">${r.toUpperCase()}</td>\n              </tr>\n              <tr class="table-row">\n                <td class="td">\n                  <p class="characteristic">Genre</p>\n                </td>\n                <td class="description">${d}</td>\n              </tr>\n            </tbody>\n          </table>\n          <h3 class="about">About</h3>\n          <p class="about-descr">\n            ${i}\n          </p>\n          <div class="buttons-wrapper">\n            <button\n              type="button"\n              class="button-modal add-to-watched"\n              data-action="add-to-watched"\n            >\n            add to watched</button\n            ><button\n              type="button"\n              class="button-modal add-to-queue"\n              data-action="add-to-queue"\n            >\n            add to queue\n            </button>\n          </div>\n        </div>\n      </div>\n      `}(n),a.insertAdjacentHTML("beforeend",r);const s=W.modalFilmWrapper.querySelector(".add-to-watched"),o=W.modalFilmWrapper.querySelector(".add-to-queue");return W.modalFilmWrapper.querySelector(".trailer-play-btn").addEventListener("click",i),s.addEventListener("click",e),o.addEventListener("click",t),l.fbFilmsData.getFilmById(k)})).then((e=>{const t=W.modalFilmWrapper.querySelector(".add-to-watched"),n=W.modalFilmWrapper.querySelector(".add-to-queue");e&&e?.id&&(e?.place!=l.PLACE_W&&e?.place2!=l.PLACE_W||(0,L.removeMod)(t,"watched"),e?.place!=l.PLACE_Q&&e?.place2!=l.PLACE_Q||(0,L.removeMod)(n,"queue"))})).catch(v.default)})),W.closeModalBtn.addEventListener("click",n)}();
//# sourceMappingURL=library.d4744f09.js.map
